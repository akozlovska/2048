!function(){function e(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function t(t){return function(t){if(Array.isArray(t))return e(t)}(t)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||function(t,n){if(t){if("string"==typeof t)return e(t,void 0);var r=Object.prototype.toString.call(t).slice(8,-1);if("Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return e(t,void 0)}}(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}var o=function(){function e(t){n(this,e),this.cells=(function(e){for(var t=[],n=0;n<16;n++){var r=document.createElement("div");r.classList.add("cell"),t.push(r),e.append(r)}return t})(t).map(function(e,t){return new c(e,t%4,Math.floor(t/4))})}return l(e,[{key:"cellsByColumns",get:function(){return this.cells.reduce(function(e,t){return e[t.x]=e[t.x]||[],e[t.x][t.y]=t,e},[])}},{key:"cellsByRows",get:function(){return this.cells.reduce(function(e,t){return e[t.y]=e[t.y]||[],e[t.y][t.x]=t,e},[])}},{key:"randomEmptyCell",get:function(){var e=this.cells.filter(function(e){return null===e.block}),t=Math.floor(Math.random()*e.length);return e[t]}}]),e}(),c=function(){function e(t,r,l){n(this,e),this.cellElement=t,this.x=r,this.y=l,this.cellElement.style.setProperty("--x",r),this.cellElement.style.setProperty("--y",l),this.block=null,this.mergeBlock=null}return l(e,[{key:"block",get:function(){return this._block},set:function(e){this._block=e,null!==e&&(this._block.x=this.x,this._block.y=this.y)}},{key:"mergeBlock",get:function(){return this._mergeBlock},set:function(e){this._mergeBlock=e,null!==e&&(this._mergeBlock.x=this.x,this._mergeBlock.y=this.y)}},{key:"canAccept",value:function(e){return null===this.block||null===this.mergeBlock&&this.block.value===e.value}},{key:"mergeBlocks",value:function(){if(null!==this.block&&null!==this.mergeBlock)return this.block.value=this.block.value+this.mergeBlock.value,this.mergeBlock.blockElement.remove(),this.mergeBlock=null,this.block.value}}]),e}(),i={Block:function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1>Math.random()?4:2;n(this,e),this.blockElement=document.createElement("div"),this.blockElement.classList.add("block"),t.append(this.blockElement),this.value=r}return l(e,[{key:"value",get:function(){return this._value},set:function(e){this._value=e,this.blockElement.textContent=e;var t=!0,n=!1,r=void 0;try{for(var l,o=this.blockElement.classList[Symbol.iterator]();!(t=(l=o.next()).done);t=!0){var c=l.value;c.includes("block--")&&this.blockElement.classList.remove(c)}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}this.blockElement.classList.add("block--".concat(e))}},{key:"x",set:function(e){this._x=e,this.blockElement.style.setProperty("--x",e)}},{key:"y",set:function(e){this._y=e,this.blockElement.style.setProperty("--y",e)}}]),e}()}.Block,s=document.querySelector(".game-field"),u=new o(s),a=document.querySelector(".game-score"),f=0,m=document.querySelector(".message-start"),h=document.querySelector(".message-lose"),d=document.querySelector(".message-win"),y=document.querySelector(".start"),k=function(){window.addEventListener("keydown",v,{once:!0})},b=function(){for(;s.firstChild;)s.removeChild(s.lastChild);u=new o(s),f=0,a.textContent=f};y.addEventListener("click",function(){"Restart"===y.textContent?(h.classList.contains("hidden")||h.classList.add("hidden"),d.classList.contains("hidden")||d.classList.add("hidden"),b()):(m.classList.add("hidden"),y.classList.remove("start"),y.classList.add("restart"),y.textContent="Restart"),u.randomEmptyCell.block=new i(s),u.randomEmptyCell.block=new i(s),k()}),y.addEventListener("keydown",function(e){("Enter"===e.code||"Space"===e.code)&&e.preventDefault()});var v=function(e){switch(e.key){case"ArrowRight":if(!L()){k();return}E();break;case"ArrowLeft":if(!C()){k();return}g();break;case"ArrowUp":if(!A()){k();return}w();break;case"ArrowDown":if(!S()){k();return}B();break;default:k();return}if(u.cells.forEach(function(e){var t=e.mergeBlocks();t&&(f+=t)}),a.textContent=f,u.cells.some(function(e){return e.block&&2048===e.block.value})){d.classList.remove("hidden");return}if(u.randomEmptyCell.block=new i(s),!A()&&!S()&&!C()&&!L()){h.classList.remove("hidden");return}k()},p=function(e){e.forEach(function(e){for(var t=1;t<e.length;t++){var n=e[t];if(null!==n.block){for(var r=null,l=t-1;l>=0;l--){var o=e[l];if(!o.canAccept(n.block))break;r=o}null!==r&&(r.block?r.mergeBlock=n.block:r.block=n.block,n.block=null)}}})},g=function(){return p(u.cellsByRows)},E=function(){return p(u.cellsByRows.map(function(e){return t(e).reverse()}))},w=function(){return p(u.cellsByColumns)},B=function(){return p(u.cellsByColumns.map(function(e){return t(e).reverse()}))},x=function(e){return e.some(function(e){return e.some(function(t,n){return 0!==n&&null!==t.block&&e[n-1].canAccept(t.block)})})},C=function(){return x(u.cellsByRows)},L=function(){return x(u.cellsByRows.map(function(e){return t(e).reverse()}))},A=function(){return x(u.cellsByColumns)},S=function(){return x(u.cellsByColumns.map(function(e){return t(e).reverse()}))}}();
//# sourceMappingURL=index.2f173537.js.map
